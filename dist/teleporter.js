!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Teleporter",[],t):"object"==typeof exports?exports.Teleporter=t():e.Teleporter=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="/dist/",t(0)}([function(e,t,n){e.exports=n(5)},function(e,t){"use strict";function n(e){var t=e.getBoundingClientRect();return r({},{top:t.top+window.scrollY,left:t.left+window.scrollX,width:t.width,height:t.height})}function i(e,t,n){var i=e.width/t.width,r=e.height/t.height,o=e.left-t.left+(e.width-t.width)/2,s=e.top-t.top+(e.height-t.height)/2;return n&&(o=Math.round(o),s=Math.round(s)),"\n		translateX("+o+"px)\n		translateY("+s+"px)\n		scaleX("+i+")\n		scaleY("+r+")\n	"}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeRect=n,t.getTransform=i},function(e,t){"use strict";function n(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e){var t={};return"number"==typeof e.animation.duration&&(t.duration=e.animation.duration),"number"==typeof e.animation.delay&&(t.delay=e.animation.delay),"string"==typeof e.animation.easing&&(t.easing=e.animation.easing),t}function r(e){if("string"!=typeof e["class"])return void console.error("Teleporter.js: No valid class passed to the teleportation step");var t={"class":e["class"]};return"number"==typeof e.opacity&&(t.opacity=e.opacity),"string"==typeof e.rotate&&(t.rotate=e.rotate),"undefined"!=typeof e.ratioSide&&(t.ratioSide=e.ratioSide),"object"===n(e.animation)&&(t.animation=i(e)),t}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});t.constructorArgument=function(e){var t={pixelRounding:!0,animation:{duration:800,delay:0,easing:"linear"}};if("string"==typeof e)return o({},t,{selector:e});if("object"===("undefined"==typeof e?"undefined":n(e))&&"string"==typeof e.selector){var r={selector:e.selector};return"string"==typeof e.sizeClass&&(r.sizeClass=e.sizeClass),"string"==typeof e.ratioSide&&(r.ratioSide=e.ratioSide),"boolean"==typeof e.pixelRounding&&(r.pixelRounding=e.pixelRounding),"object"===n(e.animation)&&(r.animation=i(e)),o({},t,r)}console.error("Teleporter.js: No valid argument passed to the constructor")},t.stepsArgument=function(e){if("string"==typeof e)return[{"class":""},{"class":e}];if("object"===("undefined"==typeof e?"undefined":n(e))){if(!Array.isArray(e))return[{"class":""},r(e)];var t=[];1===e.length&&t.push({"class":""});for(var i=0;i<e.length;i++)if("string"==typeof e[i])t.push({"class":e[i]});else{if("object"!==n(e[i])){t=void 0;break}t.push(r(e[i]))}if(t)return t}console.error("Teleporter.js: No valid argument passed to method stepsArgument")}},function(e,t){"use strict";function n(e,t,n){var i=null;return function(){var r=this,o=arguments,s=function(){i=null,n||e.apply(r,o)},a=n&&!i;clearTimeout(i),i=setTimeout(s,t),a&&e.apply(r,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=n},function(e,t,n){"use strict";function i(e,t,n){var i=(0,p.normalizeRect)(e),r={width:i.width+"px",height:i.height+"px"};"height"===n?r.height=t.height*i.width/t.width+"px":"width"===n&&(r.width=t.width*i.height/t.height+"px"),l(e.style,r)}function r(e){l(e.style,{width:null,height:null})}function o(e){var t=document.createElement("div");for(t.className="teleporter-wrapper",t.style.willChange="transform";e.childNodes.length>0;)t.appendChild(e.childNodes[0]);return e.insertBefore(t,null),t}function s(e){var t=e.children[0];if(t&&t.classList.contains("teleporter-wrapper")){for(;t.childNodes.length>0;)e.appendChild(t.childNodes[0]);e.removeChild(t)}}function a(e,t,n,i){l(e.style,{width:n.width+"px",height:n.height+"px",transform:null});var r=e.getBoundingClientRect();return l(e.style,{transform:(0,p.getTransform)(t,r,i)}),r}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};Object.defineProperty(t,"__esModule",{value:!0}),t.setElementSize=i,t.resetElementSize=r,t.setWrapper=o,t.unsetWrapper=s,t.setWrapperSize=a;var p=n(1)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),a=n(2),l=n(1),p=n(4),u=function(){function e(t){return i(this,e),r(this,(0,a.constructorArgument)(t)),this.element=document.querySelector(this.selector),this.element?(this.store={},this.element.classList.add("teleporter-idle"),window.addEventListener("resize",(0,s.debounce)(this.update.bind(this),100)),void this.update()):void console.error("Teleporter.js: No element found with the selector '"+this.selector+"'")}return o(e,[{key:"getElementRect",value:function(e,t){var n=void 0,i="string"==typeof e&&e.length>0,r=this.sizeClass&&t&&this.sizeClass!==e;return i&&this.element.classList.add(e),r&&(0,p.setElementSize)(this.element,this.sizeRect,t),n=(0,l.normalizeRect)(this.element),r&&(0,p.resetElementSize)(this.element),i&&this.element.classList.remove(e),n}},{key:"update",value:function(){(0,p.unsetWrapper)(this.element),(0,p.resetElementSize)(this.element),this.sizeRect=this.getElementRect(this.sizeClass),this.elementRect=this.getElementRect(null,this.ratioSide),(0,p.setElementSize)(this.element,this.sizeRect,this.ratioSide),this.wrapper=(0,p.setWrapper)(this.element),this.wrapperRect=(0,p.setWrapperSize)(this.wrapper,this.elementRect,this.sizeRect,this.pixelRounding),this.updateStore()}},{key:"updateStore",value:function(){var e=Object.keys(this.store).map(function(e){return JSON.parse(e)});this.store={},this.saveSteps(e)}},{key:"animate",value:function(){var e=this.runningTeleportation.steps[this.runningTeleportation.stepIndex];r(this.wrapper.style,e.webAnimation.stepStyles[1]),this.runningTeleportation.player=this.wrapper.animate(e.webAnimation.stepStyles,{duration:e.webAnimation.animation.duration,delay:e.webAnimation.animation.delay,easing:e.webAnimation.animation.easing}),this.runningTeleportation.player.addEventListener("finish",this.onAnimateEnd.bind(this),!1)}},{key:"onAnimateEnd",value:function(){this.runningTeleportation.player.removeEventListener("finish",this.onAnimateEnd.bind(this),!1),this.runningTeleportation.stepIndex<this.runningTeleportation.steps.length-1?(this.runningTeleportation.stepIndex++,this.animate()):(this.element.classList.remove("teleporter-active"),this.element.classList.add("teleporter-idle"),this.runningTeleportation.resolve())}},{key:"saveSteps",value:function(e){var t=this,n=(0,a.stepsArgument)(e),i=n.map(function(e){return{key:JSON.stringify(e),step:e}}),o=i.filter(function(e){return"undefined"==typeof t.store[e.key]});return 0===o.length?i.map(function(e){return t.store[e.key]}):((0,p.unsetWrapper)(this.element),(0,p.resetElementSize)(this.element),o.forEach(function(e){var n="undefined"!=typeof e.step.ratioSide?e.step.ratioSide:t.ratioSide;t.store[e.key]=r(e.step,{rect:t.getElementRect(e.step["class"],n)})}),(0,p.setElementSize)(this.element,this.sizeRect,this.ratioSide),this.wrapper=(0,p.setWrapper)(this.element),this.wrapperRect=(0,p.setWrapperSize)(this.wrapper,this.elementRect,this.sizeRect,this.pixelRounding),i.map(function(e){return t.store[e.key]}))}},{key:"getTeleportationSteps",value:function(e){for(var t=1;t<e.length;t++){var n=e[t-1],i=e[t];i.webAnimation={animation:r({},this.animation,i.animation),stepStyles:[{transform:(0,l.getTransform)(n.rect,this.wrapperRect,this.pixelRounding)},{transform:(0,l.getTransform)(i.rect,this.wrapperRect,this.pixelRounding)}]},n.rotate&&i.rotate&&(i.webAnimation.stepStyles[0].transform+=" rotate("+n.rotate+")",i.webAnimation.stepStyles[1].transform+=" rotate("+i.rotate+")"),"number"==typeof n.opacity&&"number"==typeof i.opacity&&(i.webAnimation.stepStyles[0].opacity=n.opacity,i.webAnimation.stepStyles[1].opacity=i.opacity)}return e}},{key:"teleport",value:function(e){var t=this;this.runningTeleportation&&this.runningTeleportation.player&&this.runningTeleportation.player.cancel();var n=this.saveSteps(e);return this.runningTeleportation={steps:this.getTeleportationSteps(n)},this.runningTeleportation.stepIndex=1,this.element.classList.remove("teleporter-idle"),this.element.classList.add("teleporter-active"),this.animate(),new Promise(function(e,n){r(t.runningTeleportation,{resolve:e,reject:n})})}}]),e}();t["default"]=u,e.exports=t["default"]}])});
//# sourceMappingURL=teleporter.js.map